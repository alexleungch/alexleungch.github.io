<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>RTCMultiConnection 多人聊天室</title>
</head>
<body>
    <div id="chat-container">
        <div id="messages" style="border:1px solid #ccc; height:300px; overflow:auto;"></div>
        <input type="text" id="message-input" placeholder="输入消息">
        <button id="send-btn">发送</button>
    </div>

    <!-- 引入 RTCMultiConnection 库 -->
    <script src="https://cdn.webrtc-experiment.com/RTCMultiConnection.js"></script>
    <script>
        // 创建一个连接对象
        var connection = new RTCMultiConnection();

        // 设置信令服务器地址 (这里可以使用你自己的信令服务器地址)
        connection.socketURL = 'http://jp.cockerltd.com:9000/';

        // 配置只传输数据，不包含音视频
        connection.session = {
            data: true
        };

        // 设置房间标识符
        var roomId = 'my-chat-room';
        connection.channel = roomId;

        // 接收消息事件
        connection.onmessage = function(event) {
            var msg = document.createElement('div');
            msg.textContent = '收到消息：' + event.data;
            document.getElementById('messages').appendChild(msg);
        };

        // 打开房间：如果你希望自己成为房主，可以使用 open，
        // 其他用户则使用 join 加入同一房间
        // 例如：connection.open(roomId);
        // 如果你希望所有人都可以同时创建或加入，则可以使用：
        connection.openOrJoin(roomId);

        // 发送消息的逻辑
        document.getElementById('send-btn').addEventListener('click', function() {
            var message = document.getElementById('message-input').value;
            if(message) {
                // 通过数据通道发送消息
                connection.send(message);

                // 显示自己发送的消息
                var msg = document.createElement('div');
                msg.textContent = '你：' + message;
                document.getElementById('messages').appendChild(msg);
                document.getElementById('message-input').value = '';
            }
        });
    </script>
</body>
</html>
